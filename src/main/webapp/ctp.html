<!DOCTYPE html>
<html>
<head>
    <title>Cryptotrading Places</title>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="jquery/jquery.css">
    <link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap-select.min.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">

    <script src="jquery/jquery-2.1.3.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="bootstrap/js/bootstrap-select.min.js"></script>
    <script src="angular/angular.min.js"></script>
</head>
<body>

<div ng-app="cryptoTrading" ng-controller="cryptoTradingController">
    <div align="center"><h1>Crypto trading places (Handel)</h1></div>

    <div align="center">
        <h3>
            {{tradingAsText}} : {{currentRate}}
        </h3>

    </div>

    <div align="center">
        <div class="btn-group btn-toolbar" role="group">
            <button type="button" class="btn btn-primary"> Grafiek</button>
            <button type="button" class="btn btn-primary"> Wallet</button>
            <button type="button" class="btn btn-primary" ng-click="getOrders()"> Orders</button>
        </div>
    </div>

    <div ng-show="showOrders" align="center">
        <h4>Market Orders</h4>


    </div>
</div>

</body>

<script>
    var app = angular.module("cryptoTrading", []);

    app.controller("cryptoTradingController", function ($scope, $http) {

        $scope.showOrders = false;

        // get current trading
        var promise = $http.get('rest/getCurrentTrading').
                           success(function (data) {
                           $scope.trading = data;
                      });

        // Wait until promise of getting current trade is is finished.
        promise.then(function () {

            // get trading site as text
            $http.get('rest/getTradingAsStringText/' + $scope.trading.id).
                    success(function (data) {
                        $scope.tradingAsText = data;
                    });

            // get current crypto trading rate
            $http.get('rest/currentCryptoRate/' + $scope.trading.id).
                    success(function (data) {
                        $scope.currentRate = data;
                    });

        });

        // Get all market orders
        $scope.getOrders = function () {
            $scope.showOrders = true;

            $http.get('rest/marketOrders/' + $scope.trading.id).
                    success(function (data) {
                        $scope.marketOrders = data;
                    });
        }
    })

</script>
</html>